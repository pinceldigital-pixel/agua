<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Water Tracker</title>
<meta name="theme-color" content="#1a1a2e"/>
<link rel="apple-touch-icon" href="icon-192.png">
<link rel="manifest" href="manifest.webmanifest">
<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@200;400;600;700&display=swap');
:root{--background-color:#12121c;--container-color:#1a1a2e;--primary-text-color:#ffffff;--secondary-text-color:#a0a0b0;--water-color:#3498db;--accent-color:#4a90e2;--accent-color-hover:#5aa1f2}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Inter',sans-serif;background-color:var(--background-color);color:var(--primary-text-color);display:flex;justify-content:center;align-items:center;min-height:100vh;-webkit-tap-highlight-color:transparent}
.container{width:100%;max-width:400px;padding:20px;text-align:center;display:flex;flex-direction:column;justify-content:space-between;height:100vh;max-height:800px}
header h1{font-size:1.5rem;color:var(--secondary-text-color);margin-bottom:2rem}
.water-tracker{flex-grow:1;display:flex;flex-direction:column;justify-content:center;align-items:center}
.percentage-display{margin-bottom:3rem}
.percentage{font-size:9rem;font-weight:200;line-height:1;color:var(--primary-text-color);transition:color .5s ease-in-out}
.details{font-size:1.2rem;color:var(--secondary-text-color);margin-top:.5rem;letter-spacing:1px}
.controls{display:flex;justify-content:center;gap:1rem}
.control-btn{background-color:var(--accent-color);color:#fff;border:none;border-radius:12px;padding:1rem 1.5rem;font-size:1.1rem;font-weight:600;cursor:pointer;transition:background-color .3s ease,transform .2s ease;box-shadow:0 4px 15px rgba(0,0,0,.2)}
.control-btn:hover{background-color:var(--accent-color-hover)}
.control-btn:active{transform:scale(.95)}
.actions{padding:1rem 0}
.action-btn{background:none;border:1px solid var(--secondary-text-color);color:var(--secondary-text-color);border-radius:8px;padding:.5rem 1rem;cursor:pointer;margin:.5rem;transition:background-color .3s ease,color .3s ease,opacity .3s ease}
.action-btn:hover{background-color:var(--secondary-text-color);color:var(--container-color)}
.action-btn:disabled{opacity:.4;cursor:not-allowed;background-color:transparent;color:var(--secondary-text-color)}
.notification-bar{position:fixed;bottom:0;left:0;right:0;background-color:#4a4a6a;color:#fff;padding:1rem;text-align:center;transform:translateY(100%);transition:transform .5s ease-in-out;font-size:.9rem}
.notification-bar.show{transform:translateY(0)}
</style>
</head>
<body>
<div class="container">
<header><h1>Monitor de Agua</h1></header>
<main class="water-tracker">
<div class="percentage-display">
<div id="percentage" class="percentage">0%</div>
<div id="details" class="details">0 / 2000 ml</div>
</div>
<div class="controls">
<button class="control-btn" data-amount="250">+ 250 ml</button>
<button class="control-btn" data-amount="500">+ 500 ml</button>
</div>
</main>
<footer class="actions">
<button id="undo-btn" class="action-btn">Deshacer</button>
<button id="reset-btn" class="action-btn">Reiniciar D√≠a</button>
<button id="notify-btn" class="action-btn">Activar Avisos</button>
</footer>
</div>
<div id="notification-bar" class="notification-bar"></div>
<script>
if('serviceWorker'in navigator){window.addEventListener('load',()=>{navigator.serviceWorker.register('./sw.js').catch(console.error);});}
document.addEventListener('DOMContentLoaded',()=>{
const percentageEl=document.getElementById('percentage');
const detailsEl=document.getElementById('details');
const addButtons=document.querySelectorAll('.control-btn');
const resetBtn=document.getElementById('reset-btn');
const undoBtn=document.getElementById('undo-btn');
const notifyBtn=document.getElementById('notify-btn');
const notificationBar=document.getElementById('notification-bar');
const GOAL=2000;let currentIntake=0;let lastAddedAmount=0;
const updateUI=()=>{const percentage=Math.min(100,currentIntake/GOAL*100);percentageEl.textContent=`${Math.round(percentage)}%`;detailsEl.textContent=`${currentIntake} / ${GOAL} ml`;undoBtn.disabled=lastAddedAmount===0;percentageEl.style.color=percentage>=100?'var(--water-color)':'var(--primary-text-color)';};
const saveData=()=>{const today=new Date().toLocaleDateString();localStorage.setItem('waterTrackerData',JSON.stringify({intake:currentIntake,date:today}));};
const loadData=()=>{const data=JSON.parse(localStorage.getItem('waterTrackerData'));const today=new Date().toLocaleDateString();if(data&&data.date===today){currentIntake=data.intake;}else{currentIntake=0;}lastAddedAmount=0;updateUI();};
addButtons.forEach(button=>{button.addEventListener('click',()=>{const amount=parseInt(button.dataset.amount,10);if(currentIntake<GOAL){lastAddedAmount=amount;currentIntake+=amount;}if(currentIntake>GOAL)currentIntake=GOAL;updateUI();saveData();});});
undoBtn.addEventListener('click',()=>{if(lastAddedAmount>0){currentIntake-=lastAddedAmount;if(currentIntake<0)currentIntake=0;lastAddedAmount=0;updateUI();saveData();showNotificationBar('√öltima adici√≥n deshecha.');}});
resetBtn.addEventListener('click',()=>{currentIntake=0;lastAddedAmount=0;updateUI();saveData();showNotificationBar('Progreso del d√≠a reiniciado.');});
let notificationInterval=null;
const showNotificationBar=(message,duration=3000)=>{notificationBar.textContent=message;notificationBar.classList.add('show');setTimeout(()=>notificationBar.classList.remove('show'),duration);}
const scheduleNotifications=()=>{
if(notificationInterval)clearInterval(notificationInterval);
showNotificationBar('¬°Notificaciones activadas! Te avisaremos cada hora entre las 9:00 y las 20:00.');
notificationInterval=setInterval(()=>{
const now=new Date();const hour=now.getHours();
const lastNotificationHour=parseInt(localStorage.getItem('lastNotificationHour')||'-1',10);
if(hour>=9&&hour<=20&&hour!==lastNotificationHour){
if(currentIntake<GOAL){
const iconHref='icon-192.png';
new Notification('¬°Recordatorio de Hidrataci√≥n!',{body:'üíß ¬°Hey! Es hora de tomar agua.',icon:iconHref,silent:false});
localStorage.setItem('lastNotificationHour',String(hour));
}else{clearInterval(notificationInterval);}
}},60*1000);
};
notifyBtn.addEventListener('click',()=>{
if(!('Notification'in window)){showNotificationBar('Tu navegador no soporta notificaciones.');return;}
if(Notification.permission==='granted'){scheduleNotifications();}
else if(Notification.permission!=='denied'){
Notification.requestPermission().then(permission=>{if(permission==='granted')scheduleNotifications();else showNotificationBar('Permiso de notificaciones denegado.');});
}else{showNotificationBar('Las notificaciones est√°n bloqueadas. Habil√≠talas en la configuraci√≥n de tu navegador.');}
});
loadData();
});
</script>
</body>
</html>
