<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AguApp Minimal</title>
  <link rel="manifest" href="manifest.webmanifest" />
  <meta name="theme-color" content="#0b3ea6" />
  <style>
    :root{--bg1:#0b3ea6;--bg2:#1e74ff;--bg3:#4da3ff;--ring:rgba(255,255,255,.18);--celeste:#8fd3ff;--wave:#5bcdff;}
    *{box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
    body{margin:0;min-height:100dvh;color:#fff;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;
      background:radial-gradient(1200px 600px at 120% -20%, rgba(255,255,255,.10), transparent 60%),
                 radial-gradient(900px 500px at -10% 120%, rgba(255,255,255,.10), transparent 60%),
                 linear-gradient(180deg, var(--bg1), var(--bg2) 45%, var(--bg3));
      overflow:hidden;position:relative;}
    
    /* --- 1. Fondo de Burbujas --- */
    .bubbles-wrap{position:absolute;top:0;left:0;right:0;bottom:0;z-index:-1;overflow:hidden;}
    .bubble{position:absolute;bottom:-100px;background:rgba(255,255,255,.1);border-radius:50%;opacity:0;animation:rise 15s infinite ease-in;}
    .bubble:nth-child(1){width:40px;height:40px;left:10%;animation-duration:12s;}
    .bubble:nth-child(2){width:20px;height:20px;left:20%;animation-duration:18s;animation-delay:2s;}
    .bubble:nth-child(3){width:50px;height:50px;left:35%;animation-duration:14s;animation-delay:4s;}
    .bubble:nth-child(4){width:80px;height:80px;left:50%;animation-duration:11s;animation-delay:0s;}
    .bubble:nth-child(5){width:35px;height:35px;left:55%;animation-duration:16s;animation-delay:5s;}
    .bubble:nth-child(6){width:45px;height:45px;left:65%;animation-duration:19s;animation-delay:1s;}
    .bubble:nth-child(7){width:25px;height:25px;left:80%;animation-duration:13s;animation-delay:3s;}
    @keyframes rise{0%{bottom:-100px;opacity:0;transform:translateX(0)}
      10%{opacity:.7}
      90%{opacity:.7}
      100%{bottom:1080px;opacity:0;transform:translateX(20px)}}

    header{display:flex;justify:content:space-between;align:items:center;padding:18px 20px;font-weight:800;font-size:24px}
    .icon{width:22px;height:22px;vertical-align:-4px}
    .icon-btn{background:transparent;border:0;color:#fff;font-size:0;cursor:pointer;opacity:.9;padding:4px}
    .icon-btn:hover{opacity:1;transform:scale(1.1)}
    main{max-width:520px;margin:0 auto;padding:10px 16px 80px}
    .card{background:rgba(255,255,255,0.06);border:1px solid var(--ring);border-radius:20px;backdrop-filter:blur(8px)}
    .center{display:grid;place-items:center;position:relative;padding:16px}
    
    /* --- 2. Efecto Agua --- */
    .donut-wrap{position:relative;width:260px;height:260px;display:grid;place-items:center;margin:8px 0;
                background:rgba(255,255,255,.25);border-radius:50%;border:1px solid var(--ring);overflow:hidden;}
    .water{width:260px;height:260px;background:var(--celeste);border-radius:50%;
           position:absolute;bottom:0;left:0;
           transform:translateY(100%); /* 100% = Vacío */
           transition:transform .9s cubic-bezier(.3,1.0,.5,1);}
    /* Las Olas */
    .water::before, .water::after{content:'';position:absolute;width:520px;height:520px;
      top:-390px;left:50%;transform:translateX(-50%);background:var(--bg2);}
    .water::before{border-radius:45%;background:rgba(30,116,255,.8);animation:wave 5s linear infinite;}
    .water::after{border-radius:42%;background:rgba(30,116,255,.4);animation:wave 7s linear infinite;opacity:.7;}
    @keyframes wave{0%{transform:translateX(-50%) rotate(0deg)}
      100%{transform:translateX(-50%) rotate(360deg)}}

    .centered{position:relative;z-index:2; /* Por encima del agua */
              display:grid;place-items:center;text-align:center;pointer-events:none;}
    .pct{font-size:48px;font-weight:900;text-shadow:0 0 8px rgba(0,0,0,.3);line-height:1}
    .sub{margin-top:2px;font-size:12px;letter-spacing:.06em;text-transform:uppercase;color:#e2e8f0}
    .grid2{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:12px;width:100%}
    .metric{padding:10px;border-radius:12px;border:1px dashed var(--ring);text-align:center}
    .metric b{display:block;font-size:20px}
    
    /* --- 5. Micro-interacción (Pop) --- */
    @keyframes pop-in{0%{transform:scale(1)}50%{transform:scale(1.4)}100%{transform:scale(1)}}
    .nowMl.pop{animation:pop-in .3s cubic-bezier(.1,1.2,.5,1);}

    /* --- 3. Selección de ML (Chips) --- */
    .amount-chips{display:grid;grid-template-columns:repeat(3, 1fr);gap:8px;margin-top:16px;width:100%;}
    .amount-chips button{appearance:none;background:transparent;border:1px solid var(--ring);color:#fff;
                         border-radius:10px;padding:12px 8px;font-size:16px;font-weight:700;cursor:pointer;
                         transition:all .2s ease;}
    .amount-chips button:hover{background:rgba(255,255,255,.2);}
    .amount-chips button.active{background:#fff;color:var(--bg1);border-color:#fff;}
    
    .controls{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:12px;width:100%}
    .btn{appearance:none;font-weight:700;border-radius:12px;padding:12px 14px;border:1px solid rgba(255,255,255,.25);background:#fff;color:#0b3ea6;
         cursor:pointer;transition:transform .1s ease;}
    .btn:active{transform:translateY(1px) scale(0.98)} /* --- 5. Micro-interacción (Botón) --- */
    
    .tip{color:#e6f0ff;font-size:12px;opacity:.85;margin-top:10px;text-align:center}
    
    /* --- 4. Panel de Ajustes --- */
    .overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.4);
             opacity:0;pointer-events:none;z-index:1000;transition:opacity .4s ease;}
    .overlay.open{opacity:1;pointer-events:auto;}
    
    .settings-panel{position:fixed;top:0;right:0;bottom:0;width:320px;max-width:90%;
                   background:#0f47bd;border-left:1px solid var(--ring);
                   transform:translateX(100%);transition:transform .4s cubic-bezier(.2,0,0,1);
                   z-index:1001;padding:18px;display:flex;flex-direction:column;}
    .settings-panel.open{transform:translateX(0);}
    .settings-panel h3{margin-top:0;}
    .settings-panel label{display:flex;justify-content:space-between;align:items:center;margin:10px 0;font-size:14px;}
    .settings-panel input{border-radius:10px;border:1px solid #84aaff;padding:8px 10px;width:100px;}
    .settings-panel .actions{display:flex;flex-wrap:wrap;gap:10px;margin-top:20px;justify-content:flex-end;}
    #permNote{font-size:12px;opacity:.9;margin-top:auto;}
  </style>
</head>
<body>
  <svg width="0" height="0" style="position:absolute">
    <symbol id="ic-gear" viewBox="0 0 24 24"><path fill="currentColor" d="M12 15.5a3.5 3.5 0 1 0 0-7a3.5 3.5 0 0 0 0 7m8.94-2.86l-1.23-.71c.07-.47.11-.95.11-1.43s-.04-.96-.11-1.43l1.23-.71a.5.5 0 0 0 .19-.68l-1.82-3.16a.5.5 0 0 0-.64-.21l-1.22.5A7.97 7.97 0 0 0 15.5 2.6l-.19-1.3A.5.5 0 0 0 14.82 1h-3.64a.5.5 0 0 0-.49.41l-.19 1.3A7.97 7.97 0 0 0 7.55 4.0l-1.22-.5a.5.5 0 0 0-.64.21L3.87 6.87a.5.5 0 0 0 .19.68l1.23.71c-.07.47-.11.95-.11-1.43s.04.96.11 1.43l-1.23.71a.5.5 0 0 0-.19.68l1.82 3.16c.13.23.41.32.64.21l1.22-.5c.66.6 1.4 1.1 2.22 1.5l.19 1.3c.05.24.25.41.49.41h3.64c.24 0 .44-.17.49-.41l.19-1.3c.82-.4 1.56-.9 2.22-1.5l1.22.5c.23.1.51.02.64-.21l1.82-3.16a.5.5 0 0 0-.19-.68z"/></symbol>
    <symbol id="ic-plus" viewBox="0 0 24 24"><path fill="currentColor" d="M19 13H13v6h-2v-6H5v-2h6V5h2v6h6z"/></symbol>
    <symbol id="ic-drop" viewBox="0 0 24 24"><path fill="currentColor" d="M12 2.69C12 2.69 6 9 6 13a6 6 0 0 0 12 0c0-4-6-10.31-6-10.31z"/></symbol>
  </svg>

  <div class="bubbles-wrap">
    <div class="bubble"></div><div class="bubble"></div><div class="bubble"></div><div class="bubble"></div>
    <div class="bubble"></div><div class="bubble"></div><div class="bubble"></div>
  </div>

  <header>
    <div>Hoy</div>
    <button id="openSettings" class="icon-btn" title="Configuración">
      <svg class="icon"><use href="#ic-gear"/></svg>
    </button>
  </header>

  <main>
    <div class="card center">
      <div class="donut-wrap">
        <div id="water" class="water"></div>
        <div class="centered">
          <div id="pct" class="pct">0%</div>
          <div class="sub">/ día</div>
        </div>
      </div>
      <div class="grid2">
        <div class="metric"><small>AHORA</small><b><span id="nowMl">0</span> ml</b></div>
        <div class="metric"><small>META</small><b><span id="goalMl">2000</span> ml</b></div>
      </div>
      
      <div id="amount" class="amount-chips">
        <button value="100">100</button>
        <button value="150">150</button>
        <button value="200">200</button>
        <button value="250" class="active">250</button>
        <button value="300">300</button>
        <button value="500">500</button>
      </div>

      <div class="controls">
        <button id="add" class="btn"><svg class="icon"><use href="#ic-plus"/></svg> Agregar</button>
        <button id="undo" class="btn" disabled>Deshacer</button>
      </div>
      <div class="tip"><svg class="icon"><use href="#ic-drop"/></svg> Consejo: mantené presionado “Agregar” para repetir.</div>
    </div>
  </main>

  <div id="overlay" class="overlay"></div>
  <div id="settings" class="settings-panel">
    <h3>Configuración</h3>
    <label>Objetivo diario (ml)<input type="number" id="goalInput" value="2000" min="200" step="50"></label>
    <label>Recordatorio cada (min)<input type="number" id="intervalInput" value="90" min="15" step="5"></label>
    <label>Desde<input type="time" id="startInput" value="09:00"></label>
    <label>Hasta<input type="time" id="endInput" value="20:00"></label>
    <div class="actions">
      <button id="testNotif" class="btn">Probar</button>
      <button id="save" class="btn">Guardar</button>
      <button id="close" class="btn" style="background:#e2e8f0;color:#0b3ea6">Cerrar</button>
    </div>
    <p id="permNote"></p>
  </div>

  <script src="main.js?v=6"></script>
</body>
</html>